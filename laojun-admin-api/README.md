# Laojun Admin API ğŸ›¡ï¸

å¤ªä¸Šè€å›å¹³å°ç®¡ç†åå° API æœåŠ¡

[![Go Version](https://img.shields.io/badge/Go-1.21+-blue.svg)](https://golang.org)
[![API Version](https://img.shields.io/badge/API-v1.0-green.svg)](./docs/api.md)
[![License](https://img.shields.io/badge/license-MIT-blue.svg)](../LICENSE)

## ğŸ“‹ æ¦‚è¿°

æœ¬æœåŠ¡æ˜¯å¤ªä¸Šè€å›å¹³å°çš„ç®¡ç†åå°æ ¸å¿ƒ APIï¼Œæä¾›å®Œæ•´çš„ç³»ç»Ÿç®¡ç†åŠŸèƒ½ï¼ŒåŒ…æ‹¬ç”¨æˆ·ç®¡ç†ã€æƒé™æ§åˆ¶ã€è§’è‰²ç®¡ç†ã€èœå•ç®¡ç†ã€ç³»ç»Ÿé…ç½®ç­‰ã€‚é‡‡ç”¨ Clean Architecture è®¾è®¡ï¼Œæ”¯æŒé«˜å¹¶å‘å’Œæ°´å¹³æ‰©å±•ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ” æƒé™ç®¡ç†
- **ç”¨æˆ·ç®¡ç†**: ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€ä¿¡æ¯ç®¡ç†ã€çŠ¶æ€æ§åˆ¶
- **è§’è‰²ç®¡ç†**: è§’è‰²åˆ›å»ºã€æƒé™åˆ†é…ã€å±‚çº§ç®¡ç†
- **æƒé™æ§åˆ¶**: åŸºäº RBAC çš„ç»†ç²’åº¦æƒé™æ§åˆ¶
- **èœå•ç®¡ç†**: åŠ¨æ€èœå•é…ç½®ã€æƒé™å…³è”

### ğŸ“Š ç³»ç»Ÿç®¡ç†
- **ç³»ç»Ÿé…ç½®**: åŠ¨æ€é…ç½®ç®¡ç†ã€å®æ—¶æ›´æ–°
- **å®¡è®¡æ—¥å¿—**: æ“ä½œæ—¥å¿—è®°å½•ã€å®‰å…¨å®¡è®¡
- **æ•°æ®ç»Ÿè®¡**: ç”¨æˆ·ç»Ÿè®¡ã€æ“ä½œç»Ÿè®¡ã€æ€§èƒ½æŒ‡æ ‡
- **ç›‘æ§å‘Šè­¦**: ç³»ç»Ÿç›‘æ§ã€å¼‚å¸¸å‘Šè­¦

### ğŸ”§ æŠ€æœ¯ç‰¹æ€§
- **é«˜æ€§èƒ½**: åŸºäº Gin æ¡†æ¶ï¼Œæ”¯æŒé«˜å¹¶å‘
- **ç¼“å­˜ä¼˜åŒ–**: Redis ç¼“å­˜ï¼Œæå‡å“åº”é€Ÿåº¦
- **æ•°æ®åº“**: PostgreSQL ä¸»ä»æ¶æ„
- **ç›‘æ§**: Prometheus æŒ‡æ ‡é‡‡é›†
- **æ–‡æ¡£**: Swagger API æ–‡æ¡£

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   HTTP Client   â”‚    â”‚   Load Balancer â”‚    â”‚   API Gateway   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                  Admin API                    â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
         â”‚  â”‚  Handlers   â”‚  â”‚  Services   â”‚  â”‚ Repositoriesâ”‚ â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ PostgreSQL  â”‚    â”‚    Redis    â”‚    â”‚ Prometheus  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ ç›®å½•ç»“æ„

```
laojun-admin-api/
â”œâ”€â”€ cmd/                    # åº”ç”¨å…¥å£
â”‚   â””â”€â”€ admin-api/         # ä¸»ç¨‹åº
â”œâ”€â”€ internal/              # å†…éƒ¨ä»£ç 
â”‚   â”œâ”€â”€ handlers/          # HTTP å¤„ç†å™¨
â”‚   â”œâ”€â”€ services/          # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”œâ”€â”€ repositories/      # æ•°æ®è®¿é—®å±‚
â”‚   â”œâ”€â”€ models/           # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ middleware/       # ä¸­é—´ä»¶
â”‚   â””â”€â”€ config/           # é…ç½®ç®¡ç†
â”œâ”€â”€ configs/              # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ config.yaml       # ä¸»é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ database.yaml     # æ•°æ®åº“é…ç½®
â”œâ”€â”€ docs/                 # æ–‡æ¡£
â”‚   â”œâ”€â”€ api.md           # API æ–‡æ¡£
â”‚   â””â”€â”€ deployment.md    # éƒ¨ç½²æ–‡æ¡£
â”œâ”€â”€ scripts/              # è„šæœ¬æ–‡ä»¶
â”œâ”€â”€ tests/               # æµ‹è¯•æ–‡ä»¶
â””â”€â”€ Dockerfile           # Docker æ„å»ºæ–‡ä»¶
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Go 1.21+
- PostgreSQL 13+
- Redis 6+

### æœ¬åœ°å¼€å‘
```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/codetaoist/laojun.git
cd laojun/laojun-admin-api

# 2. å®‰è£…ä¾èµ–
go mod download

# 3. é…ç½®ç¯å¢ƒ
cp configs/config.example.yaml configs/config.yaml
# ç¼–è¾‘é…ç½®æ–‡ä»¶

# 4. åˆå§‹åŒ–æ•°æ®åº“
make migrate

# 5. å¯åŠ¨æœåŠ¡
go run cmd/admin-api/main.go
```

### Docker éƒ¨ç½²
```bash
# æ„å»ºé•œåƒ
docker build -t laojun-admin-api .

# è¿è¡Œå®¹å™¨
docker run -p 8080:8080 laojun-admin-api
```

## ğŸ“š API æ–‡æ¡£

### è®¿é—®æ–¹å¼
- **Swagger UI**: http://localhost:8080/swagger/index.html
- **API æ–‡æ¡£**: [docs/api.md](./docs/api.md)
- **Postman Collection**: [docs/postman/](./docs/postman/)

### ä¸»è¦æ¥å£
- `POST /api/v1/auth/login` - ç”¨æˆ·ç™»å½•
- `GET /api/v1/users` - ç”¨æˆ·åˆ—è¡¨
- `POST /api/v1/users` - åˆ›å»ºç”¨æˆ·
- `GET /api/v1/roles` - è§’è‰²åˆ—è¡¨
- `POST /api/v1/roles` - åˆ›å»ºè§’è‰²

## ğŸ”§ é…ç½®è¯´æ˜

### ä¸»è¦é…ç½®é¡¹
```yaml
server:
  port: 8080
  mode: debug

database:
  host: localhost
  port: 5432
  name: laojun_admin
  
redis:
  host: localhost
  port: 6379
  
jwt:
  secret: your-secret-key
  expire: 24h
```

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œå•å…ƒæµ‹è¯•
go test ./...

# è¿è¡Œé›†æˆæµ‹è¯•
make test-integration

# ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
make test-coverage
```

## ğŸ“Š ç›‘æ§æŒ‡æ ‡

æœåŠ¡æä¾›ä»¥ä¸‹ Prometheus æŒ‡æ ‡ï¼š
- `admin_api_requests_total` - è¯·æ±‚æ€»æ•°
- `admin_api_request_duration_seconds` - è¯·æ±‚è€—æ—¶
- `admin_api_active_users` - æ´»è·ƒç”¨æˆ·æ•°
- `admin_api_database_connections` - æ•°æ®åº“è¿æ¥æ•°

## ğŸ”— ç›¸å…³é“¾æ¥

- [é¡¹ç›®ä¸»é¡µ](../README.md)
- [API æ–‡æ¡£](../../docs/api/README.md)
- [éƒ¨ç½²æŒ‡å—](../../docs/deployment/README.md)
- [å¼€å‘æŒ‡å—](../../docs/development/README.md)