# Laojun Marketplace API ğŸ›’

å¤ªä¸Šè€å›æ’ä»¶å¸‚åœº API æœåŠ¡

[![Go Version](https://img.shields.io/badge/Go-1.21+-blue.svg)](https://golang.org)
[![API Version](https://img.shields.io/badge/API-v1.0-green.svg)](./docs/api.md)
[![License](https://img.shields.io/badge/license-MIT-blue.svg)](../LICENSE)

## ğŸ“‹ æ¦‚è¿°

æœ¬æœåŠ¡æ˜¯å¤ªä¸Šè€å›å¹³å°çš„æ’ä»¶å¸‚åœºæ ¸å¿ƒ APIï¼Œæä¾›å®Œæ•´çš„æ’ä»¶ç”Ÿæ€åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ’ä»¶å±•ç¤ºã€æœç´¢ã€ä¸‹è½½ã€è¯„ä»·ã€æ”¯ä»˜ç­‰ã€‚é‡‡ç”¨å¾®æœåŠ¡æ¶æ„è®¾è®¡ï¼Œæ”¯æŒé«˜å¹¶å‘è®¿é—®å’Œå¼¹æ€§æ‰©å±•ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ”Œ æ’ä»¶ç®¡ç†
- **æ’ä»¶å±•ç¤º**: æ’ä»¶åˆ—è¡¨ã€è¯¦æƒ…å±•ç¤ºã€åˆ†ç±»æµè§ˆ
- **æœç´¢åŠŸèƒ½**: å…¨æ–‡æœç´¢ã€æ ‡ç­¾æœç´¢ã€é«˜çº§ç­›é€‰
- **ç‰ˆæœ¬ç®¡ç†**: å¤šç‰ˆæœ¬æ”¯æŒã€ç‰ˆæœ¬æ¯”è¾ƒã€å‡çº§æé†’
- **ä¾èµ–ç®¡ç†**: ä¾èµ–æ£€æŸ¥ã€è‡ªåŠ¨å®‰è£…ã€å†²çªè§£å†³

### ğŸ‘¥ ç”¨æˆ·ä½“éªŒ
- **ç”¨æˆ·è¯„ä»·**: è¯„åˆ†ç³»ç»Ÿã€è¯„è®ºç®¡ç†ã€åé¦ˆæ”¶é›†
- **ä¸ªäººä¸­å¿ƒ**: è´­ä¹°å†å²ã€æ”¶è—ç®¡ç†ã€æ¨èç®—æ³•
- **ç¤¾äº¤åŠŸèƒ½**: åˆ†äº«æ’ä»¶ã€å…³æ³¨å¼€å‘è€…ã€ç¤¾åŒºäº’åŠ¨
- **é€šçŸ¥ç³»ç»Ÿ**: æ›´æ–°é€šçŸ¥ã€æ´»åŠ¨æ¨é€ã€ç³»ç»Ÿæ¶ˆæ¯

### ğŸ’° å•†ä¸šåŠŸèƒ½
- **æ”¯ä»˜å¤„ç†**: å¤šç§æ”¯ä»˜æ–¹å¼ã€è®¢å•ç®¡ç†ã€é€€æ¬¾å¤„ç†
- **å¼€å‘è€…ç®¡ç†**: å¼€å‘è€…è®¤è¯ã€æ”¶ç›Šåˆ†æˆã€æ•°æ®ç»Ÿè®¡
- **è¥é”€å·¥å…·**: ä¿ƒé”€æ´»åŠ¨ã€ä¼˜æƒ åˆ¸ã€ä¼šå‘˜ä½“ç³»
- **æ•°æ®åˆ†æ**: ä¸‹è½½ç»Ÿè®¡ã€ç”¨æˆ·è¡Œä¸ºã€æ”¶ç›ŠæŠ¥è¡¨

### ğŸ”§ æŠ€æœ¯ç‰¹æ€§
- **é«˜æ€§èƒ½**: åŸºäº Gin æ¡†æ¶ï¼Œæ”¯æŒé«˜å¹¶å‘
- **ç¼“å­˜ä¼˜åŒ–**: å¤šçº§ç¼“å­˜ï¼Œæå‡å“åº”é€Ÿåº¦
- **æœç´¢å¼•æ“**: Elasticsearch å…¨æ–‡æœç´¢
- **æ–‡ä»¶å­˜å‚¨**: å¯¹è±¡å­˜å‚¨ï¼Œæ”¯æŒ CDN åŠ é€Ÿ
- **ç›‘æ§**: å®Œæ•´çš„ç›‘æ§å’Œå‘Šè­¦ä½“ç³»

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Web Client    â”‚    â”‚  Mobile Client  â”‚    â”‚   API Gateway   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚              Marketplace API                  â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
         â”‚  â”‚  Handlers   â”‚  â”‚  Services   â”‚  â”‚ Repositoriesâ”‚ â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ PostgreSQL  â”‚    â”‚Elasticsearchâ”‚    â”‚ Object Storeâ”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ ç›®å½•ç»“æ„

```
laojun-marketplace-api/
â”œâ”€â”€ cmd/                    # åº”ç”¨å…¥å£
â”‚   â””â”€â”€ marketplace-api/   # ä¸»ç¨‹åº
â”œâ”€â”€ internal/              # å†…éƒ¨ä»£ç 
â”‚   â”œâ”€â”€ handlers/          # HTTP å¤„ç†å™¨
â”‚   â”œâ”€â”€ services/          # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”œâ”€â”€ repositories/      # æ•°æ®è®¿é—®å±‚
â”‚   â”œâ”€â”€ models/           # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ middleware/       # ä¸­é—´ä»¶
â”‚   â””â”€â”€ config/           # é…ç½®ç®¡ç†
â”œâ”€â”€ configs/              # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ config.yaml       # ä¸»é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ database.yaml     # æ•°æ®åº“é…ç½®
â”œâ”€â”€ docs/                 # æ–‡æ¡£
â”‚   â”œâ”€â”€ api.md           # API æ–‡æ¡£
â”‚   â””â”€â”€ deployment.md    # éƒ¨ç½²æ–‡æ¡£
â”œâ”€â”€ scripts/              # è„šæœ¬æ–‡ä»¶
â”œâ”€â”€ tests/               # æµ‹è¯•æ–‡ä»¶
â””â”€â”€ Dockerfile           # Docker æ„å»ºæ–‡ä»¶
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Go 1.21+
- PostgreSQL 13+
- Redis 6+
- Elasticsearch 7+

### æœ¬åœ°å¼€å‘
```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/codetaoist/laojun.git
cd laojun/laojun-marketplace-api

# 2. å®‰è£…ä¾èµ–
go mod download

# 3. é…ç½®ç¯å¢ƒ
cp configs/config.example.yaml configs/config.yaml
# ç¼–è¾‘é…ç½®æ–‡ä»¶

# 4. åˆå§‹åŒ–æ•°æ®åº“
make migrate

# 5. å¯åŠ¨æœåŠ¡
go run cmd/marketplace-api/main.go
```

### Docker éƒ¨ç½²
```bash
# æ„å»ºé•œåƒ
docker build -t laojun-marketplace-api .

# è¿è¡Œå®¹å™¨
docker run -p 8081:8081 laojun-marketplace-api
```

## ğŸ“š API æ–‡æ¡£

### è®¿é—®æ–¹å¼
- **Swagger UI**: http://localhost:8081/swagger/index.html
- **API æ–‡æ¡£**: [docs/api.md](./docs/api.md)
- **Postman Collection**: [docs/postman/](./docs/postman/)

### ä¸»è¦æ¥å£
- `GET /api/v1/plugins` - æ’ä»¶åˆ—è¡¨
- `GET /api/v1/plugins/{id}` - æ’ä»¶è¯¦æƒ…
- `POST /api/v1/plugins/{id}/download` - ä¸‹è½½æ’ä»¶
- `POST /api/v1/plugins/{id}/reviews` - æäº¤è¯„ä»·
- `GET /api/v1/search` - æœç´¢æ’ä»¶

## ğŸ”§ é…ç½®è¯´æ˜

### ä¸»è¦é…ç½®é¡¹
```yaml
server:
  port: 8081
  mode: debug

database:
  host: localhost
  port: 5432
  name: laojun_marketplace
  
redis:
  host: localhost
  port: 6379
  
elasticsearch:
  host: localhost
  port: 9200
  
storage:
  type: s3
  bucket: laojun-plugins
```

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œå•å…ƒæµ‹è¯•
go test ./...

# è¿è¡Œé›†æˆæµ‹è¯•
make test-integration

# ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
make test-coverage
```

## ğŸ“Š ç›‘æ§æŒ‡æ ‡

æœåŠ¡æä¾›ä»¥ä¸‹ Prometheus æŒ‡æ ‡ï¼š
- `marketplace_api_requests_total` - è¯·æ±‚æ€»æ•°
- `marketplace_api_request_duration_seconds` - è¯·æ±‚è€—æ—¶
- `marketplace_api_plugin_downloads` - æ’ä»¶ä¸‹è½½æ•°
- `marketplace_api_search_queries` - æœç´¢æŸ¥è¯¢æ•°

## ğŸ”— ç›¸å…³é“¾æ¥

- [é¡¹ç›®ä¸»é¡µ](../README.md)
- [API æ–‡æ¡£](../../docs/api/README.md)
- [éƒ¨ç½²æŒ‡å—](../../docs/deployment/README.md)
- [å¼€å‘æŒ‡å—](../../docs/development/README.md)