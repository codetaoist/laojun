apiVersion: v1
kind: Service
metadata:
  name: laojun-discovery
  namespace: taishanglaojun
  labels:
    app.kubernetes.io/name: laojun-discovery
    app.kubernetes.io/component: discovery
    app.kubernetes.io/part-of: taishanglaojun-platform
  annotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8081"
    prometheus.io/path: "/metrics"
spec:
  type: ClusterIP
  ports:
    - name: http
      port: 8081
      targetPort: 8081
      protocol: TCP
    - name: metrics
      port: 9090
      targetPort: 9090
      protocol: TCP
  selector:
    app.kubernetes.io/name: laojun-discovery

---
apiVersion: v1
kind: Service
metadata:
  name: laojun-monitoring
  namespace: taishanglaojun
  labels:
    app.kubernetes.io/name: laojun-monitoring
    app.kubernetes.io/component: monitoring
    app.kubernetes.io/part-of: taishanglaojun-platform
  annotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8082"
    prometheus.io/path: "/metrics"
spec:
  type: ClusterIP
  ports:
    - name: http
      port: 8082
      targetPort: 8082
      protocol: TCP
    - name: metrics
      port: 9091
      targetPort: 9091
      protocol: TCP
  selector:
    app.kubernetes.io/name: laojun-monitoring

---
apiVersion: v1
kind: Service
metadata:
  name: redis
  namespace: taishanglaojun
  labels:
    app.kubernetes.io/name: redis
    app.kubernetes.io/component: cache
    app.kubernetes.io/part-of: taishanglaojun-platform
spec:
  type: ClusterIP
  ports:
    - name: redis
      port: 6379
      targetPort: 6379
      protocol: TCP
  selector:
    app.kubernetes.io/name: redis

---
apiVersion: v1
kind: Service
metadata:
  name: consul
  namespace: taishanglaojun
  labels:
    app.kubernetes.io/name: consul
    app.kubernetes.io/component: service-discovery
    app.kubernetes.io/part-of: taishanglaojun-platform
spec:
  type: ClusterIP
  ports:
    - name: http
      port: 8500
      targetPort: 8500
      protocol: TCP
    - name: dns
      port: 8600
      targetPort: 8600
      protocol: TCP
    - name: dns-udp
      port: 8600
      targetPort: 8600
      protocol: UDP
    - name: server
      port: 8300
      targetPort: 8300
      protocol: TCP
    - name: lan-serf
      port: 8301
      targetPort: 8301
      protocol: TCP
    - name: wan-serf
      port: 8302
      targetPort: 8302
      protocol: TCP
  selector:
    app.kubernetes.io/name: consul

---
apiVersion: v1
kind: Service
metadata:
  name: prometheus
  namespace: taishanglaojun-monitoring
  labels:
    app.kubernetes.io/name: prometheus
    app.kubernetes.io/component: monitoring
    app.kubernetes.io/part-of: taishanglaojun-platform
spec:
  type: ClusterIP
  ports:
    - name: web
      port: 9090
      targetPort: 9090
      protocol: TCP
  selector:
    app.kubernetes.io/name: prometheus

---
apiVersion: v1
kind: Service
metadata:
  name: grafana
  namespace: taishanglaojun-monitoring
  labels:
    app.kubernetes.io/name: grafana
    app.kubernetes.io/component: monitoring
    app.kubernetes.io/part-of: taishanglaojun-platform
spec:
  type: ClusterIP
  ports:
    - name: web
      port: 3000
      targetPort: 3000
      protocol: TCP
  selector:
    app.kubernetes.io/name: grafana

---
apiVersion: v1
kind: Service
metadata:
  name: influxdb
  namespace: taishanglaojun-monitoring
  labels:
    app.kubernetes.io/name: influxdb
    app.kubernetes.io/component: database
    app.kubernetes.io/part-of: taishanglaojun-platform
spec:
  type: ClusterIP
  ports:
    - name: http
      port: 8086
      targetPort: 8086
      protocol: TCP
  selector:
    app.kubernetes.io/name: influxdb

---
apiVersion: v1
kind: Service
metadata:
  name: jaeger
  namespace: taishanglaojun-monitoring
  labels:
    app.kubernetes.io/name: jaeger
    app.kubernetes.io/component: tracing
    app.kubernetes.io/part-of: taishanglaojun-platform
spec:
  type: ClusterIP
  ports:
    - name: web
      port: 16686
      targetPort: 16686
      protocol: TCP
    - name: jaeger-grpc
      port: 14250
      targetPort: 14250
      protocol: TCP
    - name: jaeger-thrift-http
      port: 14268
      targetPort: 14268
      protocol: TCP
    - name: jaeger-thrift-compact
      port: 6831
      targetPort: 6831
      protocol: UDP
    - name: jaeger-thrift-binary
      port: 6832
      targetPort: 6832
      protocol: UDP
    - name: zipkin
      port: 9411
      targetPort: 9411
      protocol: TCP
  selector:
    app.kubernetes.io/name: jaeger

---
apiVersion: v1
kind: Service
metadata:
  name: elasticsearch
  namespace: taishanglaojun-monitoring
  labels:
    app.kubernetes.io/name: elasticsearch
    app.kubernetes.io/component: search
    app.kubernetes.io/part-of: taishanglaojun-platform
spec:
  type: ClusterIP
  ports:
    - name: http
      port: 9200
      targetPort: 9200
      protocol: TCP
    - name: transport
      port: 9300
      targetPort: 9300
      protocol: TCP
  selector:
    app.kubernetes.io/name: elasticsearch

---
apiVersion: v1
kind: Service
metadata:
  name: kibana
  namespace: taishanglaojun-monitoring
  labels:
    app.kubernetes.io/name: kibana
    app.kubernetes.io/component: visualization
    app.kubernetes.io/part-of: taishanglaojun-platform
spec:
  type: ClusterIP
  ports:
    - name: web
      port: 5601
      targetPort: 5601
      protocol: TCP
  selector:
    app.kubernetes.io/name: kibana