ğŸ‰ å¤ªä¸Šè€å›å¾®æœåŠ¡å¹³å°å·²æˆåŠŸéƒ¨ç½²ï¼

ğŸ“‹ éƒ¨ç½²ä¿¡æ¯:
  Release Name: {{ .Release.Name }}
  Namespace: {{ .Release.Namespace }}
  Chart Version: {{ .Chart.Version }}
  App Version: {{ .Chart.AppVersion }}

ğŸŒ è®¿é—®åœ°å€:
{{- $domain := include "taishanglaojun.domain" . }}
{{- if .Values.ingress.enabled }}

  å¹³å°æœåŠ¡:
    ä¸»é¡µé¢: http://{{ $domain }}
    API ç½‘å…³: http://api.{{ $domain }}
    æœåŠ¡å‘ç°: http://api.{{ $domain }}/discovery
    ç›‘æ§æ¥å£: http://api.{{ $domain }}/monitoring

{{- if .Values.monitoring.enabled }}
  ç›‘æ§æœåŠ¡:
    ç›‘æ§æ€»è§ˆ: http://monitoring.{{ $domain }}
{{- if .Values.monitoring.prometheus.enabled }}
    Prometheus: http://prometheus.{{ $domain }}
{{- end }}
{{- if .Values.monitoring.grafana.enabled }}
    Grafana: http://grafana.{{ $domain }}
      ç”¨æˆ·å: {{ .Values.monitoring.grafana.admin.username }}
      å¯†ç : {{ .Values.monitoring.grafana.admin.password }}
{{- end }}
{{- if .Values.monitoring.jaeger.enabled }}
    Jaeger: http://jaeger.{{ $domain }}
{{- end }}
{{- if .Values.monitoring.kibana.enabled }}
    Kibana: http://kibana.{{ $domain }}
{{- end }}
{{- end }}

âš ï¸  è¯·ç¡®ä¿åœ¨æœ¬åœ° hosts æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹æ¡ç›®:
{{- if eq .Values.ingress.className "nginx" }}
  # è·å– NGINX Ingress Controller çš„å¤–éƒ¨ IP
  kubectl get svc -n ingress-nginx ingress-nginx-controller
{{- end }}

  # æ·»åŠ åˆ° hosts æ–‡ä»¶ (Linux/macOS: /etc/hosts, Windows: C:\Windows\System32\drivers\etc\hosts)
  127.0.0.1 {{ $domain }}
  127.0.0.1 api.{{ $domain }}
{{- if .Values.monitoring.enabled }}
  127.0.0.1 monitoring.{{ $domain }}
{{- if .Values.monitoring.prometheus.enabled }}
  127.0.0.1 prometheus.{{ $domain }}
{{- end }}
{{- if .Values.monitoring.grafana.enabled }}
  127.0.0.1 grafana.{{ $domain }}
{{- end }}
{{- if .Values.monitoring.jaeger.enabled }}
  127.0.0.1 jaeger.{{ $domain }}
{{- end }}
{{- if .Values.monitoring.kibana.enabled }}
  127.0.0.1 kibana.{{ $domain }}
{{- end }}
{{- end }}

{{- else }}

  ä½¿ç”¨ç«¯å£è½¬å‘è®¿é—®æœåŠ¡:
{{- if .Values.platform.enabled }}
  
  å¹³å°æœåŠ¡:
    kubectl port-forward svc/{{ include "taishanglaojun.fullname" . }}-platform-discovery 8081:8081 -n {{ .Values.platform.namespace | default "taishanglaojun" }}
    kubectl port-forward svc/{{ include "taishanglaojun.fullname" . }}-platform-monitoring 8082:8082 -n {{ .Values.platform.namespace | default "taishanglaojun" }}
{{- end }}

{{- if .Values.monitoring.enabled }}
  ç›‘æ§æœåŠ¡:
{{- if .Values.monitoring.prometheus.enabled }}
    kubectl port-forward svc/{{ include "taishanglaojun.fullname" . }}-monitoring-prometheus 9090:9090 -n {{ .Values.monitoring.namespace | default "taishanglaojun-monitoring" }}
{{- end }}
{{- if .Values.monitoring.grafana.enabled }}
    kubectl port-forward svc/{{ include "taishanglaojun.fullname" . }}-monitoring-grafana 3000:3000 -n {{ .Values.monitoring.namespace | default "taishanglaojun-monitoring" }}
{{- end }}
{{- if .Values.monitoring.jaeger.enabled }}
    kubectl port-forward svc/{{ include "taishanglaojun.fullname" . }}-monitoring-jaeger 16686:16686 -n {{ .Values.monitoring.namespace | default "taishanglaojun-monitoring" }}
{{- end }}
{{- if .Values.monitoring.kibana.enabled }}
    kubectl port-forward svc/{{ include "taishanglaojun.fullname" . }}-monitoring-kibana 5601:5601 -n {{ .Values.monitoring.namespace | default "taishanglaojun-monitoring" }}
{{- end }}
{{- end }}
{{- end }}

ğŸ”§ ç®¡ç†å‘½ä»¤:

  æŸ¥çœ‹çŠ¶æ€:
    helm status {{ .Release.Name }} -n {{ .Release.Namespace }}

  æŸ¥çœ‹æ‰€æœ‰èµ„æº:
    helm get all {{ .Release.Name }} -n {{ .Release.Namespace }}

  æŸ¥çœ‹æ—¥å¿—:
{{- if .Values.platform.enabled }}
    kubectl logs -f deployment/{{ include "taishanglaojun.fullname" . }}-platform-discovery -n {{ .Values.platform.namespace | default "taishanglaojun" }}
    kubectl logs -f deployment/{{ include "taishanglaojun.fullname" . }}-platform-monitoring -n {{ .Values.platform.namespace | default "taishanglaojun" }}
{{- end }}
{{- if .Values.monitoring.enabled }}
{{- if .Values.monitoring.prometheus.enabled }}
    kubectl logs -f deployment/{{ include "taishanglaojun.fullname" . }}-monitoring-prometheus -n {{ .Values.monitoring.namespace | default "taishanglaojun-monitoring" }}
{{- end }}
{{- if .Values.monitoring.grafana.enabled }}
    kubectl logs -f deployment/{{ include "taishanglaojun.fullname" . }}-monitoring-grafana -n {{ .Values.monitoring.namespace | default "taishanglaojun-monitoring" }}
{{- end }}
{{- end }}

  å‡çº§éƒ¨ç½²:
    helm upgrade {{ .Release.Name }} ./taishanglaojun -n {{ .Release.Namespace }}

  å¸è½½éƒ¨ç½²:
    helm uninstall {{ .Release.Name }} -n {{ .Release.Namespace }}

ğŸ“Š ç›‘æ§ä¿¡æ¯:
{{- if .Values.monitoring.enabled }}
{{- if .Values.monitoring.prometheus.enabled }}
  âœ… Prometheus å·²å¯ç”¨ - æŒ‡æ ‡æ”¶é›†å’Œå­˜å‚¨
{{- end }}
{{- if .Values.monitoring.grafana.enabled }}
  âœ… Grafana å·²å¯ç”¨ - å¯è§†åŒ–ä»ªè¡¨æ¿
{{- end }}
{{- if .Values.monitoring.jaeger.enabled }}
  âœ… Jaeger å·²å¯ç”¨ - åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª
{{- end }}
{{- if .Values.monitoring.influxdb.enabled }}
  âœ… InfluxDB å·²å¯ç”¨ - æ—¶åºæ•°æ®åº“
{{- end }}
{{- if .Values.monitoring.elasticsearch.enabled }}
  âœ… Elasticsearch å·²å¯ç”¨ - æ—¥å¿—å­˜å‚¨å’Œæœç´¢
{{- end }}
{{- if .Values.monitoring.kibana.enabled }}
  âœ… Kibana å·²å¯ç”¨ - æ—¥å¿—åˆ†æå’Œå¯è§†åŒ–
{{- end }}
{{- else }}
  âš ï¸  ç›‘æ§æ ˆæœªå¯ç”¨
{{- end }}

ğŸ”’ å®‰å…¨ä¿¡æ¯:
{{- if .Values.rbac.enabled }}
  âœ… RBAC å·²å¯ç”¨
{{- end }}
{{- if .Values.networkPolicy.enabled }}
  âœ… ç½‘ç»œç­–ç•¥å·²å¯ç”¨
{{- end }}
{{- if .Values.podSecurityPolicy.enabled }}
  âœ… Pod å®‰å…¨ç­–ç•¥å·²å¯ç”¨
{{- end }}

ğŸ’¾ å­˜å‚¨ä¿¡æ¯:
{{- if .Values.persistence.enabled }}
  âœ… æŒä¹…åŒ–å­˜å‚¨å·²å¯ç”¨
  å­˜å‚¨ç±»: {{ include "taishanglaojun.storageClass" . | default "é»˜è®¤" }}
{{- else }}
  âš ï¸  æŒä¹…åŒ–å­˜å‚¨æœªå¯ç”¨ - æ•°æ®å°†åœ¨ Pod é‡å¯æ—¶ä¸¢å¤±
{{- end }}

ğŸ“š æ›´å¤šä¿¡æ¯:
  - æŸ¥çœ‹å®Œæ•´æ–‡æ¡£: https://github.com/codetaoist/laojun
  - Helm Chart æ–‡æ¡£: ./helm/README.md
  - æ•…éšœæ’é™¤æŒ‡å—: ./helm/README.md#æ•…éšœæ’é™¤

ğŸ¯ ä¸‹ä¸€æ­¥:
  1. éªŒè¯æ‰€æœ‰ Pod éƒ½åœ¨è¿è¡Œ: kubectl get pods --all-namespaces
  2. æ£€æŸ¥æœåŠ¡çŠ¶æ€: kubectl get svc --all-namespaces
  3. è®¿é—® Grafana ä»ªè¡¨æ¿é…ç½®ç›‘æ§å‘Šè­¦
  4. æŸ¥çœ‹ Jaeger äº†è§£æœåŠ¡è°ƒç”¨é“¾è·¯
  5. ä½¿ç”¨ API æ¥å£æµ‹è¯•æœåŠ¡åŠŸèƒ½

æ„Ÿè°¢ä½¿ç”¨å¤ªä¸Šè€å›å¾®æœåŠ¡å¹³å°ï¼ğŸš€